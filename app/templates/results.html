<html>
    <head>
        <link rel="stylesheet" href="static/bootstrap.min.css">
        <link rel="stylesheet" href="/static/main.css"/>
        <link rel="stylesheet" href="/static/all.css"/>
        <link href="/static/sliptree-bootstrap-tokenfield-9c06df4/dist/css/bootstrap-tokenfield.min.css" rel="stylesheet" type="text/css">
        <script src="static/jquery-3.3.1.min.js" type = "text/javascript"></script>
        <script type="text/javascript" src="/static/sliptree-bootstrap-tokenfield-9c06df4/dist/bootstrap-tokenfield.min.js"></script>
        <script type="text/javascript" src="/static/bootstrap3-typeahead.min.js"></script>
        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script> 

        <script type="text/javascript">
            /*Scroll to top when arrow up clicked BEGIN*/
            $(window).scroll(function() {
                var height = $(window).scrollTop();
                if (height > 100) {
                    $('#back2Top').fadeIn();
                } else {
                     $('#back2Top').fadeOut();
                 }
            });
            // var bgImageArray = ["/static/boysoverflowers-faded.png", "/static/pinocchio-faded.png", "/static/Goong-faded.png", "/static/SurplusPrincess-faded.png", "/static/Youwhocamefromthestars-faded.png" ];
            // var	base = "";
            // var	secs = 5;
            // function backgroundSequence() {
            //     var k = 0;
            //     for (var i = 0; i < bgImageArray.length; i++) {
            //         setTimeout(function(){
            //             document.body.style.background = 'url('+bgImageArray[k]+') no-repeat center center fixed';
            //             document.body.style.backgroundSize ="cover";
            //             if ((k+1) == bgImageArray.length) {
            //                 setTimeout(function() {
            //                     backgroundSequence(); }, (secs * 1000));
            //             }
            //             else {
            //                 k++;
            //             }
            //         }, (secs * 1000) * i) ;
            //     }
            // }



            $(document).ready(function() {
            // backgroundSequence();
             $("#back2Top").click(function(event) {
                event.preventDefault();
                $("html, body").animate({ scrollTop: 0 }, "slow");
                return false;
                });

                $(".img-click").click(function(event){
                    var x = $(this).attr("href");
                    console.log(x);
                    if (document.querySelector(x).classList.contains('hidden')) {
                        $(x).removeClass("hidden");
                        $(this).addClass("hidden");
                        $('.dis').addClass('hidden');
                    }else {
                        $(x).addClass("hidden");
                        $('.dis').removeClass("hidden");
                        $(this).removeClass('hidden');
                        $(".img-click").removeClass('hidden');
                    }
                });
                $(".score").click(function(event){
                    var x = $(this).attr("href")+"scoreh";
                    var y = $(this).attr("href")+"infoh";
                    var z = $(this).attr("href")+"cast";
                    console.log(x);
                    if (document.querySelector(x).classList.contains('hidden')) {
                        $(x).removeClass('hidden');
                        $(y).addClass('hidden');
                        $(z).addClass('hidden');
                    }
                });
                $(".info").click(function(event){
                    var x = $(this).attr("href")+"scoreh";
                    var y = $(this).attr("href")+"infoh";
                    var z = $(this).attr("href")+"cast";
                    console.log(x);
                    if (document.querySelector(y).classList.contains('hidden')) {
                        $(y).removeClass('hidden');
                        $(x).addClass('hidden');
                        $(z).addClass('hidden');

                    }

                });
                $(".cast").click(function(event){
                    var x = $(this).attr("href")+"scoreh";
                    var y = $(this).attr("href")+"infoh";
                    var z = $(this).attr("href")+"cast";
                    console.log(z);
                    if (document.querySelector(z).classList.contains('hidden')) {
                        $(z).removeClass('hidden');
                        $(x).addClass('hidden');
                        $(y).addClass('hidden');

                    }

                });

                // $("#more-display").click(function(event){
                //     var numresult
                //  });

            });
            /*Scroll to top when arrow up clicked END*/
        </script>
    </head>
    <body id = "resultsform">

            <form class="form-inline global-search content">
            <div> <button id ='new-search' type="submit" class="btn btn-info" name = 'new-search'> Make a new Search </button></div>
            <!-- <a id = 'new-search' href=#>Make a New search</a> -->
                 <div class = "gallary_class">
                   {% if not output.empty %}
                         {% for y in output %}
                     <br>
                    <div class = "gallaryimg">
                           <img class = 'dis' src="/static/Show_Images/{{ y[: y.index(',')] }}.jpg" alt= '/static/Show_Images/A Gentlemanâ€™s Dignity.jpg'/>
                           <a class = "img-click" name = "img-click" href ="#{{ y[: y.find(',')].replace(' ', '').replace('/', '').replace(':', '').replace('(', '').replace(')', '').replace('.','')}}" >
                            <div class= 'titleh'>
                                <h2>{{  y[: y.index(',')] }}</h2>
                                <div class = 'Similarity'><p>{{  y[y.index("Similarity Score:"):y.index(", Sentiment Score:")] }}%</p></div>

                             </div>
                            </a>
                    </div>
                     <div class = "main-cointainer hidden" id = "{{ y[: y.find(',')].replace(' ', '').replace('/', '').replace(':', '').replace('(', '').replace(')', '').replace('.','')}}">
                        
                            <div class = "info-container">
                                <div class = 'left-side'>
                                   
                                    <a class = "img-click" name = "img-click" href ="#{{ y[: y.find(',')].replace(' ', '').replace('/', '').replace(':', '').replace('(', '').replace(')', '').replace('.','')}}" ><img src="/static/Show_Images/{{ y[: y.index(',')] }}.jpg" alt= "/static/Show_Images/A Gentleman's Dignity.jpg"/></a>
                                </div>
                                <div class = "right-side">
                                    <h2>{{  y[: y.index(',')] }}</h2>
                                <div class = "mini-nav">
                                <nav>
                                        <ul>
                                            <li><a class = "info" href="#{{ y[: y.find(',')].replace(' ', '').replace('/', '').replace(':', '').replace('(', '').replace(')', '').replace('.','')}}">Overview</a></li>
                                            <li><a class = "cast" href="#{{ y[: y.find(',')].replace(' ', '').replace('/', '').replace(':', '').replace('(', '').replace(')', '').replace('.','')}}">Actors</a></li>
                                            <li><a class = "score" href="#{{ y[: y.find(',')].replace(' ', '').replace('/', '').replace(':', '').replace('(', '').replace(')', '').replace('.','')}}">Similarity Score</a></li>

                                        </ul>
                                    </nav>
                                </div>
                                <div class = "display_info">
                                                
                                        <div id = "{{ y[: y.find(',')].replace(' ', '').replace('/', '').replace(':', '').replace('(', '').replace(')', '').replace('.','')}}infoh">
                                           
                                            <div class = 'rating'><p><strong> Rating: </strong>{{  y[y.find('Rating:')+7 :  y.index(', Runtime')] }}</p><p class = 'right'><strong> Year: </strong>{{  y[y.index('Years:')+6 :y.index(',  Sentiment:')] }}</p></div>
                                            <div class = 'genre'><p><strong> Genres: </strong>{{  y[y.find('Genre:')+6 : y.index(', Rating')] }}</p><p class = "right"><strong> Runtime: </strong>{{  y[y.find('Runtime:')+ 8 :y.index(', Actors')] }}</p></div>
                                            <div class = 'votes'><p><strong> Votes: </strong>{{  y[y.find('Votes')+6 :y.index(', Years')] }}</p></div>

                                            <div class = 'Summary'><p><strong> Summary: </strong>{{y[y.find('Summary:')+8: y.index(',  Genre')] }}</p></div>
                                        </div>

                                        <div id ="{{ y[: y.find(',')].replace(' ', '').replace('/', '').replace(':', '').replace('(', '').replace(')', '').replace('.','')}}cast" class = "hidden" >
                                            <div class = 'actors'><strong> Actors: </strong>
                                                {%for x in  y[y.find('Actors:')+ 7 :y.index(', Votes')].split(', ') %}
                                                    <p>{{x}}</p>
                                                {%endfor%}
                                            </div>
                                        </div>
                                            
                                        
                                        <div id = "{{ y[: y.find(',')].replace(' ', '').replace('/', '').replace(':', '').replace('(', '').replace(')', '').replace('.','')}}scoreh" class = "hidden">
                                            <script type="text/javascript">
                                                // Load google charts
                                                google.charts.load('current', {'packages':['corechart']});
                                                google.charts.setOnLoadCallback(drawChart);
                                                
                                                // Draw the chart and set the chart values
                                               
                                                function drawChart() {
                                                    var total_sim = parseFloat( '{{  y[y.index("Similarity Score:")+18 :y.index(", Sentiment Score:")] }}' );
                                                    console.log('total:' +total_sim);
                                                    var sentiment_score = parseFloat( '{{  y[y.index("Sentiment Score")+16 :y.index(", Embedding")] }}' );
                                                    console.log(sentiment_score);
                                                    
                                                    var  embedding_score =  parseFloat( '{{  y[y.index("Embedding Score")+16 :y.index(", Summary")] }}' );
                                                    console.log(embedding_score);
                                                    
                                                    var summary_score = parseFloat( '{{  y[y.index("Summary Score")+1 :y.index(", Actor")] }}' );
                                                    console.log('summary '+summary_score);

                                                    var actors_score = parseFloat( '{{  y[y.index("Actor Score")+12 :y.index(", Genre")] }}' );
                                                    console.log(actors_score);
                                                    var genre_score = parseFloat( "{{  y[y.index('Genre Score')+12 : ]}}" );
                                                    console.log(genre_score);
                                                  var data = google.visualization.arrayToDataTable([
                                                  ['Inputs', 'Match Percentage'],
                                                  ['Total Similarity Score', total_sim],
                                                  ['Sentiment Score', sentiment_score],
                                                  ['Embedding Score', embedding_score],
                                                  ['Summary Score', summary_score],
                                                  ['Actor Score', actors_score],
                                                  ['Genre Score', genre_score]
                                                ]);
                                                
                                                  // Optional; add a title and set the width and height of the chart
                                                  var options = {'title':'Similarity Scores', 'width':500, 'height':300};
                                                
                                                
                                                  var chart = new google.visualization.ColumnChart(document.getElementById("{{ y[: y.find(',')].replace(' ', '').replace('/', '').replace(':', '').replace('(', '').replace(')', '').replace('.','')}}Similarity"));
                                                  chart.draw(data, options);
                                                }
                                                </script> 
                                            <div class= "sentiment"> <strong>Sentiment:</strong> {{  y[y.index("Sentiment:")+11 :y.index(", Sentiment Reviews")] }}  </div>
                                                <div class =  "users_message"><p>{{output_message}}</p>

                                    
                                                    
                                                </div>
                                            <div id = "{{ y[: y.find(',')].replace(' ', '').replace('/', '').replace(':', '').replace('(', '').replace(')', '').replace('.','')}}Similarity"></div>
                                            <div class = 'reviews'>
                                                <strong>Sentiment Reviews:</strong>
                                                {% for r in y[y.index("Sentiment Reviews:")+21 :y.index(', Total')-2].replace("'", '"').split('", "') %} 
                                                <p class = "r_style">{{r}}</p>
                                                {%endfor%}
                                                <!-- {% for s in y[y.index("Sentiment Reviews:")+20 :y.index(', Total')].split() %} 
                                                <p>{{s}}</p>
                                                {%endfor%} -->
                                            
                                            
                                            </div> 
                                        </div>
                                       
                                </div>
                            </div>
                            </div>
                        </div>
                        
                        {% endfor %}

                    {% endif %}
                

                </div>

           </form>
           <a id="back2searches" title="Back to top" href="#"> &#10148; </a>
           <a id="back2Top" title="Back to top" href="#"> &#10148; </a>


           <!-- <a id="back2Top" title="Back to top" href="#">&Darr; </a> -->

    <footer>
        <div>
            <p>Project Name: {{ name }}</p>
            <p>Student Name: ({{ netid }})</p>
        </div>
    </footer>

    </body>

</html>
